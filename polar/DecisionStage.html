{% extends "global/Page.html" %}
{{ block title }}
Decision
{{ endblock }}
{{ block content }}

<div class="card my-3">
    <div class="card-body">
        <div class="card-text">
            <ul class="list-group list-group-flush">
                <li class="list-group-item">
                    Now you will make a choice towards Participant B:

                </li>
                <li class="list-group-item mx-3">

                    - As explained, you have at your disposal $1.00.
                </li>
                <li class="list-group-item mx-3">
                    - Participant B has received $0.50.

                </li>
                <li class="list-group-item">
                    Your decision:

                </li>
                <li class="list-group-item mx-3">
                    - You can give nothing, or up to $0.50 of your money to Participant B (choose any positive amount or
                    zero below).

                </li>
                <li class="list-group-item mx-3">
                    - You can take nothing, or up to $0.50 from the money of Participant B (choose any negative amount
                    or
                    zero below).

                </li>

            </ul>
        </div>
    </div>
</div>
{% if player.field_maybe_none('reveal') or subsession.treatment == 'forced_reveal' %}
    <div class="card my-3">
        <div class="card-body">
            <div class="card-text">
                <ul class="list-group list-group-flush">
                    <li class="list-group-item">
                        The Participant B you are matched with <span
                            class="fw-bolder text-danger lead">{{ player.get_partner_opinion }}</span> with the
                        following statement:
                    </li>
                    <li class="list-group-item text-center lead my-3">
                        {{ Constants.statement_lgbt }}
                    </li>
                    <li class="list-group-item">
                        {{ Constants.privacy_note }}
                    </li>
            </div>
        </div>
    </div>
{% endif %}
<div class="card my-3">
    <div class="card-header">
        Your decision
    </div>


    <div class="card-body">
        <div class="card-text">
            <div class="mb-3 _formfield">

                <div class="controls d-flex flex-lg-row flex-sm-column">
                    {% for ch in player.html_dg_decision_choices %}
                        <div class="form-check form-check-inline">

                            <input class="form-check-input dg-decision" type="radio" id="id_dg_decision-{{ ch.id }}"
                                   name="dg_decision"
                                   required=""
                                   value="{{ ch.value }}">
                            <label for="id_dg_decision-{{ ch.id }}" class="form-check-label">{{ ch.label }}</label>
                        </div>
                    {% endfor %}
                </div>
            </div>
            <ol class="list-group  ">
                <li class="list-group-item d-flex justify-content-between align-items-start">
                    <div class="ms-2 me-auto">
                        <div class="fw-bold">Your bonus:</div>

                    </div>
                    <div class="display-6">
                        <span class="badge bg-primary rounded-pill"><span id="ownpayoff"></span></span>
                    </div>
                </li>
                <li class="list-group-item d-flex justify-content-between align-items-start">
                    <div class="ms-2 me-auto">
                        <div class="fw-bold">Participant B's bonus:</div>

                    </div>
                    <div class="display-6">
                        <span class="badge bg-primary rounded-pill "><span id="alterpayoff"></span></span>
                    </div>
                </li>

            </ol>
        </div>
    </div>
</div>


<script>
    const formatter = (i)=>{return (i/100).toFixed(2)+'$'}
    const $own = $('#ownpayoff')
    const $alter = $('#alterpayoff')
    const egoendowment = {{ player.egoendowment|json }}
    const alterendowment = {{ player.alterendowment|json }}
    const egopayoff = formatter(egoendowment)
    const alterpayoff = formatter(alterendowment)
    $own.html( egopayoff)
    $alter.html( alterpayoff)
    $('.dg-decision').change(function(){
        const val = $(this).val();
        const egopayoff = formatter(egoendowment-parseInt(val))
        const alterpayoff = formatter(alterendowment+parseInt(val))
        $own.html( egopayoff)
        $alter.html( alterpayoff)
    })
</script>

{{ next_button }}

{{ endblock }}
